<div class="custom-font" *ngFor="let question of questions; let qi = index; TrackBy:questionTrackBy">
  <ng-container *ngIf="
      question?.sectionHeader &&
      (!question.visibleIf?.length || question.canDisplay == true)
    ">
    <h4 class="section-header-style">{{ question?.sectionHeader }}</h4>
    <hr [ngStyle]="{
        'background-color':
          question.responseType != 'pageQuestions' ? 'rebeccapurple' : null,
        height: question.responseType != 'pageQuestions' ? '3px' : 0
      }" />
  </ng-container>
  <div [ngStyle]="{
      padding: question.responseType != 'pageQuestions' ? '30px' : 0
    }" [ngClass]="{
      'mat-elevation-z8': question.responseType != 'pageQuestions',
      activeCard: question.responseType != 'pageQuestions'
    }" class="responsive-margin" style="border-radius: 10px" *ngIf="!question.visibleIf?.length || question.canDisplay == true">
    <div [ngClass]="{ content: question.responseType != 'pageQuestions' }">
      <div>
        <div *ngFor="let q of question.question; let qai = index" style="margin-bottom: 20px">
          <div  *ngIf="q != ''" style="color: rgb(99, 55, 187)">
            {{ question.questionNumber + " . " }}&nbsp;{{ q }}
            <button *ngIf="question?.hint" mat-icon-button style="color: rebeccapurple;" aria-label="Icon-button with a lightbulb icon"
              matTooltip="Hint about the question" (click)="openDialog(qi)">
              <mat-icon style="vertical-align: middle;">emoji_objects_outline</mat-icon>
            </button>
            <mat-divider style="margin-top: 10px" [ngStyle]="{
                'background-color':
                  question.responseType != 'pageQuestions'
                    ? 'rebeccapurple'
                    : null
              }">
            </mat-divider>
          </div>
        </div>
      </div>
      <ng-container *ngIf="question?.tip">
        <p style="font-size: smaller; color: gray">{{ question?.tip }}</p>
      </ng-container>
      <div style="margin-bottom: 10px;display: flex;flex-direction: column;gap: 10px;">
        <lib-text-input *ngIf="question.responseType == reponseType.TEXT" [questionnaireForm]="questionnaireForm"
          [question]="question"></lib-text-input>
        <ng-container *ngIf="
            question.responseType == reponseType.PAGEQUESTIONS;
            pageQuestions
          ">
          <lib-main [questions]="question.pageQuestions" [questionnaireForm]="questionnaireForm" [assessmentInfo]="assessmentInfo"></lib-main>
        </ng-container>
        <lib-number-input *ngIf="question.responseType == reponseType.NUMBER" [questionnaireForm]="questionnaireForm"
          [question]="question"></lib-number-input>
        <lib-radio-input *ngIf="question.responseType == reponseType.RADIO" [questionnaireForm]="questionnaireForm"
          [question]="question" [options]="question.options"
          (dependentParent)="toggleQuestion($event)"></lib-radio-input>
        <lib-checkbox-input *ngIf="question.responseType == reponseType.MULTISELECT"
          [questionnaireForm]="questionnaireForm" [question]="question" [options]="question.options"
          (dependentParent)="toggleQuestion($event)"></lib-checkbox-input>
        <lib-range-input *ngIf="question.responseType == reponseType.SLIDER" [questionnaireForm]="questionnaireForm"
          [question]="question"></lib-range-input>
        <lib-date-input *ngIf="question.responseType == reponseType.DATE" [questionnaireForm]="questionnaireForm"
          [question]="question"></lib-date-input>
        <lib-matrix-questions *ngIf="question.responseType == reponseType.MATRIX"
          [questionnaireForm]="questionnaireForm" [question]="question" #libMatrix>
          <ng-template #libMainTemplateRef>
            <lib-main [questions]="libMatrix.context.questions" [questionnaireForm]="libMatrix.matrixForm" [assessmentInfo]="assessmentInfo"></lib-main>
          </ng-template>
        </lib-matrix-questions>
        <lib-remarks [question]="question" *ngIf="question.showRemarks"></lib-remarks>
        <!-- <lib-attachment *ngIf="question.file" [data]="{
          submissionId: qService.getSubmissionId(),
          files: question.fileName,
          index:question._id+qi
        }">
        </lib-attachment> -->
        <lib-dialog *ngIf="dimmerIndex == qi && question?.hint" [isDimmed]="isDimmed" [hint]="question?.hint"
          (closeHintEmitter)="closeHint()"></lib-dialog>
      </div>
    </div>
  </div>
</div>